language: ruby
os: osx
rvm: system
sudo: required

env:
  global:
    - HOMEBREW_DEVELOPER=1
    - HOMEBREW_FORCE_VENDOR_RUBY=1
    - HOMEBREW_NO_AUTO_UPDATE=1

before_install:
  - HOMEBREW_TAP_DIR="$(brew --repo "$TRAVIS_REPO_SLUG")"
  - rm -rf "$HOMEBREW_TAP_DIR"
  - mkdir -p "$(dirname "$HOMEBREW_TAP_DIR")"
  - ln -s "$PWD" "$HOMEBREW_TAP_DIR"
  - env | grep TRAVIS | tee /tmp/travis.env

script:
  - brew test-bot --no-bottle

notifications:
  email:
    on_success: never
    on_failure: always
